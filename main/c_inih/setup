#!/QOpenSys/usr/bin/ksh

set -e

TARGET=${TARGET:-OSSILE}

system -kpieb "CRTSRCPF FILE(${TARGET}/QSRVSRC) RCDLEN(112)" || :

system -kpieb "CPYFRMSTMF FROMSTMF('$PWD/inih.bnd') TOMBR('/QSYS.LIB/${TARGET}.LIB/QSRVSRC.FILE/INIH.MBR') MBROPT(*REPLACE)"

system -kpieb "CRTCMOD MODULE(${TARGET}/INIH) SRCSTMF('$PWD/inih/ini.c') SYSIFCOPT(*IFS64IO) TERASPACE(*YES *TSIFC) STGMDL(*INHERIT) INCDIR('$PWD/inih') DEFINE('INI_MAX_LINE=1000')"

system -kpieb "CRTSRVPGM SRVPGM(${TARGET}/INIH) MODULE(${TARGET}/INIH) STGMDL(*INHERIT) EXPORT(*SRCFILE) SRCFILE(${TARGET}/QSRVSRC) TEXT('Simple INI parser')"
